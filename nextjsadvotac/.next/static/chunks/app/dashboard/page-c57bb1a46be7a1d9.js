(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{63:(e,a,s)=>{"use strict";var r=s(7260);s.o(r,"useParams")&&s.d(a,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(a,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(a,{useSearchParams:function(){return r.useSearchParams}})},116:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>h});var r,t=s(5155),l=s(63),i=s(2115);s(6423);var o=s(5704);let n=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"],c=[{value:"advocate",label:"Advocate"},{value:"lawyer",label:"Lawyer"},{value:"intern",label:"Intern"},{value:"organisation",label:"Organisation"}],d=null!=(r=o.env.NEXT_PUBLIC_FASTAPI_BASE_URL)?r:"https://api.advotac.com";function h(){let e=(0,l.useRouter)(),[a,s]=(0,i.useState)(null),[r,o]=(0,i.useState)(null),[h,u]=(0,i.useState)(!0),[x,m]=(0,i.useState)(!1),[v,j]=(0,i.useState)(!1),[p,g]=(0,i.useState)(null),[f,w]=(0,i.useState)(null),[N,S]=(0,i.useState)(null),[A,k]=(0,i.useState)(!1),[b,C]=(0,i.useState)(null),[y,D]=(0,i.useState)(""),[B,R]=(0,i.useState)("");(0,i.useEffect)(()=>{M()},[]);let M=async()=>{console.log("\uD83D\uDD04 [DASHBOARD] Checking authentication..."),await new Promise(e=>setTimeout(e,100));let e=localStorage.getItem("authToken"),a=localStorage.getItem("userData");if(!e){console.error("❌ [DASHBOARD] No token found"),window.location.replace("/auth");return}w(e);try{if(a){let e=JSON.parse(a);s({id:e.id||e.email,name:e.name,email:e.email,image:e.image})}console.log("\uD83D\uDCE1 [DASHBOARD] Checking user profile...");let r=await fetch("".concat(d,"/user-info"),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(r.ok){let e=await r.json();console.log("✅ [DASHBOARD] User profile found:",e),o(e),m(!1)}else if(404===r.status)console.log("ℹ️ [DASHBOARD] No profile found, showing setup form"),m(!0);else if(401===r.status||403===r.status){console.error("❌ [DASHBOARD] Unauthorized"),localStorage.clear(),window.location.replace("/auth");return}}catch(e){console.error("❌ [DASHBOARD] Error:",e),g("Failed to load profile data")}finally{u(!1)}},H=async(e,a,s)=>{k(!0),C(null);try{let r=new URLSearchParams;a&&r.append("user_id",a),s&&r.append("user_email",s);let t=await fetch("".concat(d,"/api/assistant/credits?").concat(r.toString()),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(404===t.status)return void S(0);if(!t.ok)throw Error("Failed to load credits (status ".concat(t.status,")"));let l=await t.json();S(l.credits)}catch(e){console.error("❌ [DASHBOARD] Failed to fetch credit balance:",e),C("Failed to load credits"),S(null)}finally{k(!1)}};(0,i.useEffect)(()=>{f&&(null==a?void 0:a.id)&&(async()=>{await H(f,a.id,a.email)})()},[f,null==a?void 0:a.id,null==a?void 0:a.email]);let z=async e=>{if(e.preventDefault(),!y||!B)return void g("Please select both state and role");j(!0),g(null);try{let e=localStorage.getItem("authToken");if(!e){g("Authentication token not found. Please login again."),localStorage.clear(),window.location.replace("/auth");return}let s={state:y,iam_a:B,full_name:null==a?void 0:a.name,profile_pic:null==a?void 0:a.image,email:null==a?void 0:a.email,user_status:"active"};console.log("\uD83D\uDCE4 [DASHBOARD] Submitting profile setup:",s),console.log("\uD83D\uDD11 [DASHBOARD] Token exists:",!!e);let r=await fetch("".concat(d,"/user-info"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(s)});if(console.log("\uD83D\uDCE1 [DASHBOARD] Response status:",r.status),r.ok){let e=await r.json();console.log("✅ [DASHBOARD] Profile created successfully:",e),o(e),m(!1)}else{let e=await r.text();console.error("❌ [DASHBOARD] Response error:",e);try{let a=JSON.parse(e);throw Error(a.detail||"Failed to create profile")}catch(a){throw Error("Server error (".concat(r.status,"): ").concat(e))}}}catch(a){console.error("❌ [DASHBOARD] Error creating profile:",a);let e=a instanceof Error?a.message:"Failed to create profile";g(e),alert("Error: ".concat(e))}finally{j(!1)}};return h?(0,t.jsxs)("div",{className:"dashboard-loading",children:[(0,t.jsx)("div",{className:"spinner"}),(0,t.jsx)("p",{children:"Loading dashboard..."})]}):x?(0,t.jsx)("div",{className:"dashboard-wrapper",children:(0,t.jsxs)("div",{className:"profile-setup-container",children:[(0,t.jsxs)("div",{className:"setup-header",children:[(0,t.jsx)("h1",{children:"Complete Your Profile"}),(0,t.jsx)("p",{children:"Tell us a bit more about yourself to get started"})]}),a&&(0,t.jsxs)("div",{className:"user-preview",children:[a.image&&(0,t.jsx)("img",{src:a.image,alt:a.name,className:"user-avatar"}),(0,t.jsxs)("div",{className:"user-details",children:[(0,t.jsx)("h3",{children:a.name}),(0,t.jsx)("p",{children:a.email})]})]}),(0,t.jsxs)("form",{onSubmit:z,className:"setup-form",children:[p&&(0,t.jsx)("div",{className:"error-message",children:p}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"state",children:"Select Your State *"}),(0,t.jsxs)("select",{id:"state",value:y,onChange:e=>D(e.target.value),required:!0,className:"form-select",children:[(0,t.jsx)("option",{value:"",children:"Choose a state..."}),n.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"role",children:"I am a *"}),(0,t.jsxs)("select",{id:"role",value:B,onChange:e=>R(e.target.value),required:!0,className:"form-select",children:[(0,t.jsx)("option",{value:"",children:"Choose your role..."}),c.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,t.jsx)("button",{type:"submit",disabled:v,className:"submit-button",children:v?"Setting up...":"Complete Setup"})]})]})}):(0,t.jsxs)("div",{className:"dashboard-container",children:[(0,t.jsxs)("aside",{className:"sidebar",children:[(0,t.jsx)("div",{className:"sidebar-header",children:(0,t.jsxs)("div",{className:"logo",children:[(0,t.jsx)("img",{src:"/advotac_logo.png",alt:"Advotac Logo",className:"logo-image"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Advotac"}),(0,t.jsx)("p",{children:"Legal AI Workspace"})]})]})}),(0,t.jsxs)("nav",{className:"sidebar-nav",children:[(0,t.jsxs)("a",{href:"/dashboard",className:"nav-item active",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})}),"Overview"]}),(0,t.jsxs)("a",{href:"/assistant",className:"nav-item",children:[(0,t.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,t.jsx)("path",{d:"M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"}),(0,t.jsx)("path",{d:"M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"})]}),"Assistant"]}),(0,t.jsxs)("a",{href:"/research",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.255 0-2.443.29-3.5.804V12a1 1 0 11-2 0V4.804z"})}),"Research"]}),(0,t.jsxs)("a",{href:"/drafting",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})}),"Drafting"]}),(0,t.jsxs)("a",{href:"/workflow",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),"Workflow"]}),(0,t.jsxs)("a",{href:"/history",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),"History"]})]}),(0,t.jsxs)("div",{className:"sidebar-footer",children:[(0,t.jsxs)("a",{href:"/settings",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),"Settings"]}),(0,t.jsxs)("button",{onClick:()=>{console.log("\uD83D\uDEAA [DASHBOARD] Signing out..."),localStorage.clear(),window.location.replace("/auth")},className:"nav-item logout-btn",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z",clipRule:"evenodd"})}),"Logout"]})]})]}),(0,t.jsxs)("main",{className:"main-content",children:[(0,t.jsxs)("header",{className:"dashboard-header",children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,t.jsx)("h1",{children:"Dashboard"}),(0,t.jsxs)("div",{className:"credit-balance-header",children:["Credit Balance:\xa0",A?"...":null!==N?N:"—",b&&(0,t.jsx)("span",{style:{marginLeft:"0.5rem",color:"#f87171",fontSize:"0.85rem"},children:"(refresh to retry)"})]})]}),(0,t.jsxs)("div",{className:"header-actions",children:[(0,t.jsxs)("div",{className:"search-box",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),(0,t.jsx)("input",{type:"text",placeholder:"Search matters, drafts..."})]}),(0,t.jsx)("button",{className:"icon-button",children:(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})}),(0,t.jsx)("button",{className:"icon-button profile-button",onClick:()=>window.location.href="/settings",title:"Go to Settings",children:(null==a?void 0:a.image)?(0,t.jsx)("img",{src:a.image,alt:a.name,className:"user-avatar-small"}):(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})})]})]}),(0,t.jsxs)("div",{className:"dashboard-grid",children:[(0,t.jsxs)("div",{className:"feature-card",onClick:()=>e.push("/assistant"),style:{cursor:"pointer"},children:[(0,t.jsx)("div",{className:"card-icon assistant",children:(0,t.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}),(0,t.jsx)("circle",{cx:"9",cy:"10",r:"1",fill:"currentColor"}),(0,t.jsx)("circle",{cx:"12",cy:"10",r:"1",fill:"currentColor"}),(0,t.jsx)("circle",{cx:"15",cy:"10",r:"1",fill:"currentColor"})]})}),(0,t.jsxs)("div",{className:"card-content",children:[(0,t.jsx)("h3",{children:"Assistant"}),(0,t.jsx)("p",{children:"Chat, cite, and act with guardrails"})]}),(0,t.jsx)("button",{className:"card-menu",onClick:e=>e.stopPropagation(),children:"⋯"})]}),(0,t.jsxs)("div",{className:"feature-card",onClick:()=>e.push("/research"),style:{cursor:"pointer"},children:[(0,t.jsx)("div",{className:"card-icon research",children:(0,t.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),(0,t.jsx)("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"}),(0,t.jsx)("path",{d:"M8 7h8"}),(0,t.jsx)("path",{d:"M8 11h8"}),(0,t.jsx)("path",{d:"M8 15h6"})]})}),(0,t.jsxs)("div",{className:"card-content",children:[(0,t.jsx)("h3",{children:"Research"}),(0,t.jsx)("p",{children:"Statutes, case law, cross refs"})]}),(0,t.jsx)("button",{className:"card-menu",onClick:e=>e.stopPropagation(),children:"⋯"})]}),(0,t.jsxs)("div",{className:"feature-card",onClick:()=>e.push("/drafting"),style:{cursor:"pointer"},children:[(0,t.jsx)("div",{className:"card-icon drafting",children:(0,t.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,t.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),(0,t.jsxs)("div",{className:"card-content",children:[(0,t.jsx)("h3",{children:"Drafting"}),(0,t.jsx)("p",{children:"Contracts, petitions, notices"})]}),(0,t.jsx)("button",{className:"card-menu",onClick:e=>e.stopPropagation(),children:"⋯"})]}),(0,t.jsxs)("div",{className:"feature-card",onClick:()=>e.push("/workflow"),style:{cursor:"pointer"},children:[(0,t.jsx)("div",{className:"card-icon workflow",children:(0,t.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),(0,t.jsx)("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),(0,t.jsx)("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"}),(0,t.jsx)("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),(0,t.jsx)("path",{d:"M6.5 10v4M17.5 10v4"})]})}),(0,t.jsxs)("div",{className:"card-content",children:[(0,t.jsx)("h3",{children:"Workflow"}),(0,t.jsx)("p",{children:"Automate intake to filing"})]}),(0,t.jsx)("button",{className:"card-menu",onClick:e=>e.stopPropagation(),children:"⋯"})]})]})]})]})}},6423:()=>{},9099:(e,a,s)=>{Promise.resolve().then(s.bind(s,116))}},e=>{e.O(0,[7835,8441,1255,7358],()=>e(e.s=9099)),_N_E=e.O()}]);