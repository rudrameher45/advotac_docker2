(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5125],{63:(e,a,s)=>{"use strict";var t=s(7260);s.o(t,"useParams")&&s.d(a,{useParams:function(){return t.useParams}}),s.o(t,"useRouter")&&s.d(a,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(a,{useSearchParams:function(){return t.useSearchParams}})},5207:(e,a,s)=>{Promise.resolve().then(s.bind(s,6232))},6232:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>o});var t=s(5155),r=s(63),i=s(2115);s(6820);let l=[{value:"General",label:"General"},{value:"Analysis Docs",label:"Analysis Docs"},{value:"Summary",label:"Summary"},{value:"Deeper Insights",label:"Deeper Insights"},{value:"Citation Check",label:"Citation Check"}],n="https://api.advotac.com/";function o(){let e=(0,r.useRouter)(),[a,s]=(0,i.useState)(null),[o,c]=(0,i.useState)(!0),[d,h]=(0,i.useState)([]),[u,x]=(0,i.useState)("General"),[m,p]=(0,i.useState)(""),[v,g]=(0,i.useState)(!1),[j,y]=(0,i.useState)(!1),[f,w]=(0,i.useState)(null);(0,i.useEffect)(()=>{let a=localStorage.getItem("authToken"),t=localStorage.getItem("userData");if(!a||!t){console.log("❌ [ASSISTANT] No auth found, redirecting to login"),e.push("/auth");return}try{let e=JSON.parse(t);s(e),c(!1)}catch(a){console.error("❌ [ASSISTANT] Error parsing user data:",a),localStorage.clear(),e.push("/auth")}},[e]);let k=async()=>{if(!m.trim()&&!d.some(e=>"application/pdf"===e.type||e.name.toLowerCase().endsWith(".pdf")))return void w("Please enter a query or attach a PDF document.");let s=(null==a?void 0:a.id)||(null==a?void 0:a.email)||null;if(!s||!(null==a?void 0:a.email))return void w("Unable to identify the current user. Please sign in again.");y(!0),w(null);try{if(!["General","Analysis Docs"].includes(u))return void alert('Task "'.concat(u,'" is coming soon! Currently only the "General" and "Analysis Docs" tasks are available.'));if("Analysis Docs"===u){var t,r,i,l;let a=d.find(e=>"application/pdf"===e.type||e.name.toLowerCase().endsWith(".pdf"));if(!m.trim()&&!a)return void w("Please provide either text or attach a PDF document for analysis.");let s=null;if(a)try{let e=await new Promise((e,s)=>{let t=new FileReader;t.onload=()=>{let a=t.result;"string"==typeof a?e(a):s(Error("Unable to read file content."))},t.onerror=()=>s(Error("Failed to read the selected file.")),t.readAsDataURL(a)});s=e.split(",").pop()||e}catch(e){console.error("[ASSISTANT] Failed to read PDF:",e),w(e instanceof Error?e.message:"Unable to read the selected PDF file.");return}let o=m.trim(),c={top_points:5};s?(c.pdf_base64=s,o&&(c.instructions=o)):o&&(c.text=o);let x=await fetch("".concat(n,"/api/assistant/analysis"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!x.ok){let e=await x.json().catch(()=>null),a=e&&"object"==typeof e&&"detail"in e?e.detail:"Failed to analyse the document.";throw Error(a)}let v=await x.json(),g="undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():"".concat(Date.now(),"-").concat(Math.random().toString(16).slice(2)),j="ana-".concat(g),y=new Date().toISOString(),f={token:j,task:u,query:m,created_at:y,summary:null!=(t=v.summary)?t:"",analysis:null!=(i=null!=(r=v.analysis)?r:v.summary)?i:"",key_points:Array.isArray(v.key_points)?v.key_points:[],keywords:Array.isArray(v.keywords)?v.keywords:[],comparisons:Array.isArray(v.comparisons)?v.comparisons:[],table_markdown:"string"==typeof v.table_markdown?v.table_markdown:null,truncated:!!v.truncated,input_characters:"number"==typeof v.input_characters?v.input_characters:0,source:null!=(l=v.source)?l:"text"};try{sessionStorage.setItem("analysisTask:".concat(j),JSON.stringify(f)),sessionStorage.setItem("latestAnalysis",JSON.stringify(f))}catch(e){console.warn("[ASSISTANT] Failed to persist analysis response to sessionStorage:",e)}e.push("/assistant/task/".concat(j)),h([]),p("");return}let o=await fetch("".concat(n,"/api/assistant/query-v2"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:m,top_k:5,threshold:.7,validate:!0,task_name:u,user_id:s,user_email:a.email})});if(!o.ok){let e=await o.json().catch(()=>null),a=e&&"object"==typeof e&&"detail"in e?e.detail:"Failed to fetch answer";throw Error(a)}let c=await o.json(),x="undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():"".concat(Date.now(),"-").concat(Math.random().toString(16).slice(2)),v="gen-".concat(x),g={token:v,task:u,type:"general",query:m,created_at:new Date().toISOString(),response:c};try{sessionStorage.setItem("assistantTask:".concat(v),JSON.stringify(g))}catch(e){console.warn("[ASSISTANT] Failed to persist response to sessionStorage:",e)}try{await fetch("".concat(n,"/api/assistant/general-history"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v,task_name:u,query:m,response:c,user_id:s,user_email:a.email,created_at:g.created_at})})}catch(e){console.warn("[ASSISTANT] Failed to persist general history:",e)}e.push("/assistant/task/".concat(v))}catch(e){console.error("Error fetching answer:",e),w(e instanceof Error?e.message:"An error occurred while processing your request")}finally{y(!1)}};return o?(0,t.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"#f7f9fc"},children:(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)("div",{style:{fontSize:"24px",marginBottom:"16px",color:"#0E8587"},children:"Loading..."})})}):(0,t.jsxs)("div",{className:"dashboard-container",children:[(0,t.jsxs)("aside",{className:"sidebar",children:[(0,t.jsx)("div",{className:"sidebar-header",children:(0,t.jsxs)("div",{className:"logo",children:[(0,t.jsx)("img",{src:"/advotac_logo.png",alt:"Advotac Logo",className:"logo-image"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Advotac"}),(0,t.jsx)("p",{children:"Legal AI Workspace"})]})]})}),(0,t.jsxs)("nav",{className:"sidebar-nav",children:[(0,t.jsxs)("a",{href:"/dashboard",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})}),"Overview"]}),(0,t.jsxs)("a",{href:"/assistant",className:"nav-item active",children:[(0,t.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,t.jsx)("path",{d:"M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"}),(0,t.jsx)("path",{d:"M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"})]}),"Assistant"]}),(0,t.jsxs)("a",{href:"/research",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.255 0-2.443.29-3.5.804V12a1 1 0 11-2 0V4.804z"})}),"Research"]}),(0,t.jsxs)("a",{href:"/drafting",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})}),"Drafting"]}),(0,t.jsxs)("a",{href:"/workflow",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),"Workflow"]}),(0,t.jsxs)("a",{href:"/history",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),"History"]})]}),(0,t.jsxs)("div",{className:"sidebar-footer",children:[(0,t.jsxs)("a",{href:"/settings",className:"nav-item",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),"Settings"]}),(0,t.jsxs)("button",{onClick:()=>{localStorage.clear(),window.location.replace("/auth")},className:"nav-item logout-btn",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z",clipRule:"evenodd"})}),"Logout"]})]})]}),(0,t.jsxs)("main",{className:"main-content",children:[(0,t.jsxs)("header",{className:"dashboard-header",children:[(0,t.jsx)("h1",{children:"Assistant"}),(0,t.jsxs)("div",{className:"header-actions",children:[(0,t.jsxs)("div",{className:"search-box",children:[(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),(0,t.jsx)("input",{type:"text",placeholder:"Search conversations..."})]}),(0,t.jsx)("button",{className:"icon-button",children:(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})}),(0,t.jsx)("button",{className:"icon-button profile-button",onClick:()=>window.location.href="/settings",title:"Go to Settings",children:(null==a?void 0:a.image)?(0,t.jsx)("img",{src:a.image,alt:a.name,className:"user-avatar-small"}):(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})})]})]}),(0,t.jsx)("div",{className:"assistant-content",children:(0,t.jsxs)("div",{className:"assistant-wrapper",children:[(0,t.jsx)("div",{className:"assistant-icon",children:(0,t.jsx)("div",{className:"icon-square",children:(0,t.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"white",stroke:"white",strokeWidth:"2",children:[(0,t.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}),(0,t.jsx)("circle",{cx:"9",cy:"10",r:"1",fill:"white"}),(0,t.jsx)("circle",{cx:"12",cy:"10",r:"1",fill:"white"}),(0,t.jsx)("circle",{cx:"15",cy:"10",r:"1",fill:"white"})]})})}),(0,t.jsx)("h1",{className:"assistant-heading",children:"How can I assist you today?"}),(0,t.jsx)("p",{className:"assistant-subheading",children:"Ask me anything and attach documents for deeper analysis."}),(0,t.jsxs)("div",{className:"input-container",children:[(0,t.jsxs)("div",{className:"textarea-wrapper",children:[(0,t.jsx)("textarea",{className:"assistant-textarea",placeholder:'Type your request or question here. E.g "What are the key elements required to establish a claim of promissory estoppel in contract law?"',rows:4,value:m,onChange:e=>p(e.target.value)}),(0,t.jsx)("button",{className:"attach-file-btn",title:"Attach File",onClick:()=>{let e=document.createElement("input");e.type="file",e.multiple=!0,e.accept="application/pdf",e.onchange=e=>{let a=e.target.files;a&&h(e=>[...e,...Array.from(a)])},e.click()},children:(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,t.jsx)("path",{d:"M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"})})})]}),d.length>0&&(0,t.jsx)("div",{className:"attached-items",children:d.map((e,a)=>(0,t.jsxs)("div",{className:"file-tag",children:[(0,t.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("path",{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"}),(0,t.jsx)("polyline",{points:"13 2 13 9 20 9"})]}),(0,t.jsx)("span",{children:e.name}),(0,t.jsx)("button",{className:"remove-file-btn",onClick:()=>{h(e=>e.filter((e,s)=>s!==a))},children:(0,t.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,t.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},"".concat(e.name,"-").concat(a)))}),(0,t.jsxs)("div",{className:"input-actions",children:[(0,t.jsxs)("div",{className:"task-select",children:[(0,t.jsx)("label",{htmlFor:"assistantTask",children:"Select a task"}),(0,t.jsx)("select",{id:"assistantTask",value:u,onChange:e=>x(e.target.value),children:l.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{className:"advanced-mode",children:[(0,t.jsx)("span",{children:"Advanced Mode"}),(0,t.jsxs)("label",{className:"toggle-switch",children:[(0,t.jsx)("input",{type:"checkbox",id:"advancedToggle",checked:v,onChange:()=>g(e=>!e)}),(0,t.jsx)("span",{className:"toggle-slider"})]}),(0,t.jsx)("button",{className:"help-btn",title:"Click for info",onClick:()=>alert("Standard Mode: 2 credits per request\nAdvanced Mode: 5 credits per request"),children:(0,t.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("path",{d:"M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"}),(0,t.jsx)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})})]})]}),(0,t.jsx)("button",{type:"button",className:"submit-button get-result-button",onClick:k,disabled:j||!m.trim(),children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"spinner",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10",strokeOpacity:"0.25"}),(0,t.jsx)("path",{d:"M12 2a10 10 0 0 1 10 10",strokeLinecap:"round"})]}),"Processing..."]}):"Get Answer"})]}),f&&(0,t.jsxs)("div",{className:"error-message",children:[(0,t.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,t.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),(0,t.jsx)("span",{children:f})]})]})})]})]})}},6820:()=>{}},e=>{e.O(0,[3827,8441,1255,7358],()=>e(e.s=5207)),_N_E=e.O()}]);